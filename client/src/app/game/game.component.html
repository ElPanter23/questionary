<div class="card">
  <h2 class="text-center mb-4">ðŸŽ® {{ i18nService.getTranslation('questionCharacterGame') }}</h2>
  
  <!-- Charakter-Auswahl -->
  <div class="mb-4">
    <h3>{{ i18nService.getTranslation('selectCharacter') }}</h3>
    <div class="grid grid-2 mt-4" *ngIf="characters.length > 0">
      <div 
        *ngFor="let character of characters" 
        class="character-card"
        [class.selected]="selectedCharacter?.id === character.id"
        (click)="selectCharacter(character)">
        <h3>{{ character.name }}</h3>
        <p>{{ character.description || i18nService.getTranslation('noDescription') }}</p>
        <div class="status-badge" [class.completed]="getCharacterStatus(character.id)?.answered_count === getCharacterStatus(character.id)?.total_questions">
          {{ getCharacterStatus(character.id)?.answered_count || 0 }} / {{ getCharacterStatus(character.id)?.total_questions || 0 }} {{ i18nService.getTranslation('questions') }}
        </div>
      </div>
    </div>
    
    <div *ngIf="characters.length === 0" class="text-center">
      <p>{{ i18nService.getTranslation('noCharactersAvailable') }}</p>
      <a routerLink="/characters" class="btn">{{ i18nService.getTranslation('manageCharacters') }}</a>
    </div>
  </div>

  <!-- Season Selection -->
  <div class="mb-4" *ngIf="characters.length > 0">
    <h3>{{ i18nService.getTranslation('selectSeason') }}</h3>
    <div class="form-group">
      <select 
        class="form-control" 
        [(ngModel)]="selectedSeason" 
        (ngModelChange)="onSeasonChange()">
        <option value="">{{ i18nService.getTranslation('allSeasons') }}</option>
        <option *ngFor="let season of availableSeasons" [value]="season">
          {{ i18nService.getTranslation('season') }} {{ season }}
        </option>
      </select>
    </div>
  </div>

  <!-- Aktuelle Frage -->
  <div *ngIf="currentQuestion && selectedCharacter" class="question-card">
    <h2>{{ currentQuestion.question.text }}</h2>
    <div class="question-meta">
      <span *ngIf="currentQuestion.question.category">{{ i18nService.getTranslation('category') }}: {{ currentQuestion.question.category }}</span>
      <span *ngIf="currentQuestion.question.difficulty"> â€¢ {{ i18nService.getTranslation('season') }}: {{ currentQuestion.question.difficulty }}</span>
    </div>
    
    <div class="answer-section mt-4">
      <label for="answerText" class="form-label">{{ i18nService.getTranslation('yourAnswer') }}</label>
      <textarea 
        id="answerText"
        class="form-control textarea answer-textarea" 
        [(ngModel)]="currentAnswer"
        [placeholder]="i18nService.getTranslation('enterAnswerHere')"
        rows="4"
        maxlength="1000">
      </textarea>
      <div class="answer-counter">
        {{ currentAnswer.length || 0 }} / 1000 {{ i18nService.getTranslation('characters') }}
      </div>
    </div>
    
    <div class="mt-4">
      <button 
        class="btn" 
        (click)="markAsAnswered()"
        [disabled]="!currentAnswer || currentAnswer.trim() === ''">
        âœ… {{ i18nService.getTranslation('saveAnswer') }}
      </button>
      <button class="btn btn-secondary btn-margin-left" (click)="getNewQuestion()">
        ðŸ”„ {{ i18nService.getTranslation('newQuestion') }}
      </button>
    </div>
  </div>

  <!-- Keine Fragen verfÃ¼gbar -->
  <div *ngIf="noQuestionsAvailable && selectedCharacter" class="text-center">
    <h3>ðŸŽ‰ {{ i18nService.getTranslation('allQuestionsAnswered') }}</h3>
    <p>{{ i18nService.getTranslation('allQuestionsAnsweredFor') }} {{ selectedCharacter.name }} {{ i18nService.getTranslation('questions') }}.</p>
    <button class="btn btn-secondary" (click)="resetCharacter()">
      ðŸ”„ {{ i18nService.getTranslation('resetCharacter') }}
    </button>
  </div>

  <!-- Lade-Status -->
  <div *ngIf="loading" class="loading">
    <p>{{ i18nService.getTranslation('loading') }}</p>
  </div>

  <!-- Fehler -->
  <div *ngIf="error" class="error">
    {{ error }}
  </div>

  <!-- Erfolg -->
  <div *ngIf="successMessage" class="success">
    {{ successMessage }}
  </div>
</div>
